<!doctype html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="generator"
            content="Docutils 0.19: https://docutils.sourceforge.io/"
        />

        <title>sobolev_alignment package &#8212; Sobolev Alignment</title>
        <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
        <link
            rel="stylesheet"
            type="text/css"
            href="../_static/alabaster.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="../_static/copybutton.css"
        />
        <script
            data-url_root="../"
            id="documentation_options"
            src="../_static/documentation_options.js"
        ></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <link rel="index" title="Index" href="../genindex.html" />
        <link rel="search" title="Search" href="../search.html" />
        <link rel="prev" title="sobolev_alignment" href="modules.html" />

        <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

        <meta
            name="viewport"
            content="width=device-width, initial-scale=0.9, maximum-scale=0.9"
        />
    </head>
    <body>
        <div class="document">
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body" role="main">
                        <section id="sobolev-alignment-package">
                            <h1>
                                sobolev_alignment package<a
                                    class="headerlink"
                                    href="#sobolev-alignment-package"
                                    title="Permalink to this heading"
                                    >¶</a
                                >
                            </h1>
                            <section id="submodules">
                                <h2>
                                    Submodules<a
                                        class="headerlink"
                                        href="#submodules"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                            </section>
                            <section
                                id="module-sobolev_alignment.SobolevAlignment"
                            >
                                <span
                                    id="sobolev-alignment-sobolevalignment-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.SobolevAlignment module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.SobolevAlignment"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Sobolev Alignment implementation.</p>
                                <p>
                                    Main class for Sobolev Alignment, which
                                    wraps all the different operations presented
                                    in Sobolev Alignment procedure: - Model
                                    selection (scVI and KRR) - scVI models
                                    training. - Synthetic models generations. -
                                    KRR approximation. - Alignment of KRR
                                    models.
                                </p>
                            </section>
                            <section
                                id="module-sobolev_alignment.feature_analysis"
                            >
                                <span
                                    id="sobolev-alignment-feature-analysis-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.feature_analysis module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.feature_analysis"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Feature analysis.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    This modules contains all the codes used in
                                    the Taylor expansion for the Gaussian/Matern
                                    kernel.
                                </p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.feature_analysis.basis"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.feature_analysis.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >basis</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >x</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >k</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >gamma</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.feature_analysis.basis"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Compute the basis function for a
                                            single gene, except offset term.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >x: np.array</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Column vector (each
                                                            row corresponds to a
                                                            sample).
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong>k: int</strong>
                                                    </dt>
                                                    <dd>
                                                        <p>Order to compute.</p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >gamma:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Parameter of Matérn
                                                            kernel.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>np.array</dt>
                                                    <dd>
                                                        <p>
                                                            Value of the higher
                                                            order feature.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.feature_analysis.combinatorial_product"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.feature_analysis.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >combinatorial_product</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >x</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >idx</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >gamma</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.feature_analysis.combinatorial_product"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Compute the basis function for a
                                            single gene, except offset term.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >x: np.array</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Data matrix with
                                                            samples in the rows
                                                            and genes in the
                                                            columns
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >idx: tuple</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Combinations, i.e.
                                                            tuple of features to
                                                            take into account.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >gamma:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Parameter of Matérn
                                                            kernel.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        scipy.sparse.csc_matrix
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Values of the higher
                                                            order feature.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.feature_analysis.higher_order_contribution"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.feature_analysis.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >higher_order_contribution</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >d</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >data</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><span class="pre"
                                                    >array</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sample_offset</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><span class="pre"
                                                    >array</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >gene_names</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#list"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >list</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >gamma</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#float"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >float</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >n_jobs</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >1</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >return_matrix</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#bool"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >bool</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >False</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.feature_analysis.higher_order_contribution"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Compute the features corresponding
                                            to the Taylor expansion of the
                                            kernel.
                                        </p>
                                        <p>
                                            Compute the features corresponding
                                            to the Taylor expansion of the
                                            kernel, i.e. $x_j exp^{-gamma xx^T}$
                                            for linear features. Returns a
                                            sparse pandas DataFrame containing
                                            all the features (columns) by
                                            samples (rows). We here critically
                                            rely on the sparsity of the
                                            data-matrix to speed up
                                            computations. The current
                                            implementation is relevant in two
                                            cases: -When dimensionality is small
                                            -When data is sparse.
                                        </p>
                                        <p>
                                            High-dimensional and dense data
                                            matrices would lead to a significant
                                            over-head without computational
                                            gains, and could benefit from
                                            another implementation strategy.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong>d: int</strong>
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Order of the
                                                            features to compute,
                                                            e.g. 1 for linear, 2
                                                            for interaction
                                                            terms.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >data:
                                                            np.array</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Data to compute
                                                            features on, samples
                                                            in the rows and
                                                            genes (features) in
                                                            the columns.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >sample_offset:
                                                            np.array</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Offset of each
                                                            sample from data.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >gene_names:
                                                            list</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Names of each
                                                            columns in data ;
                                                            corresponds to
                                                            features naming.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >gamma:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Value of the gamma
                                                            parameter for Matérn
                                                            kernel.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >n_jobs: int,
                                                            default to 1</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of concurrent
                                                            threads to use. -1
                                                            will use all CPU
                                                            cores possible.
                                                            WARNING: for d &gt;=
                                                            2 and a large number
                                                            of genes, the
                                                            routine can be
                                                            memory-intensive and
                                                            a high n_jobs could
                                                            lead to crash.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >return_matrix:
                                                            bool, default to
                                                            False</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            If True, then
                                                            returns simply the
                                                            feature-matrix
                                                            without
                                                            feature-naming. In
                                                            cases when feature
                                                            names are not
                                                            relevant (e.g.
                                                            computing the
                                                            proportion of
                                                            non-linearities),
                                                            return_matrix=True
                                                            can help speed-up
                                                            the process.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>pd.DataFrame</dt>
                                                    <dd>
                                                        <p>
                                                            Sparse dataframe
                                                            with samples in the
                                                            rows and named
                                                            features in the
                                                            columns. For
                                                            instance, when d=1,
                                                            returns each column
                                                            of data scaled by
                                                            RKHS normalisation
                                                            factor and
                                                            multiplied by offset
                                                            value.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.generate_artificial_sample"
                            >
                                <span
                                    id="sobolev-alignment-generate-artificial-sample-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.generate_artificial_sample
                                    module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.generate_artificial_sample"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Generate artificial samples.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    Generate samples using scVI decoder from a
                                    multivariate gaussian noise. This module
                                    generates the training data used to
                                    approximate the VAE encoding functions by
                                    Matérn kernel machines.
                                </p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.generate_artificial_sample.generate_samples"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.generate_artificial_sample.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >generate_samples</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sample_size</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_names</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#list"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >list</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >covariates_values</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#list"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >list</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >lib_size</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#dict"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >dict</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >model</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><span class="pre"
                                                    >SCVI</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_key_dict</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#dict"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >dict</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >return_dist</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#bool"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >bool</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >False</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.generate_artificial_sample.generate_samples"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Generate artificial gene expression
                                            profiles.
                                        </p>
                                        <p>
                                            Note to developers: this method has
                                            been designed to be used with
                                            scvi-tools classes. Other VAE
                                            implementations may break here.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >sample_size:
                                                            int</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of samples to
                                                            generate.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_names: list
                                                            or np.ndarray,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            List or array with
                                                            sample_size str
                                                            values indicating
                                                            the batch of each
                                                            sample.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >covariate_values:
                                                            list or np.ndarray,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            List or array with
                                                            sample_size float
                                                            values indicating
                                                            the covariate values
                                                            of each sample to
                                                            generate (as for
                                                            training scVI
                                                            model).
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >lib_size</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dictionary of mean
                                                            library size per
                                                            batch.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong>model</strong>
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            scVI model which
                                                            decoder is here
                                                            exploited to
                                                            generate samples.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_key_dict</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dictionary linking
                                                            the values of the
                                                            batch (scVI) and the
                                                            key used in scVI.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >return_dist: bool,
                                                            default to
                                                            False</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Whether to return
                                                            the distribution
                                                            parameters (True) or
                                                            samples from this
                                                            distribution
                                                            (False).
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        If return_dist if False,
                                                        torch.Tensor (on CPU)
                                                        with artificial samples
                                                        in the rows.
                                                    </dt>
                                                    <dd></dd>
                                                    <dt>
                                                        If return_dist if True,
                                                        torch.Tensor with
                                                        distribution parameters
                                                        (following scVI
                                                    </dt>
                                                    <dd></dd>
                                                    <dt>
                                                        order) and one
                                                        torch.Tensor with
                                                        artificial samples in
                                                        the rows (CPU).
                                                    </dt>
                                                    <dd></dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.generate_artificial_sample.parallel_generate_samples"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.generate_artificial_sample.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >parallel_generate_samples</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sample_size</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_names</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >covariates_values</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >lib_size</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >model</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_key_dict</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/typing.html#typing.Optional"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >Optional</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >[</span
                                                    ></span
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#dict"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >dict</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >]</span
                                                    ></span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >None</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >return_dist</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#bool"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >bool</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >False</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_size</span
                                                ></span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >1000</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >n_jobs</span
                                                ></span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >1</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.generate_artificial_sample.parallel_generate_samples"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Generate artificial gene expression
                                            profiles.
                                        </p>
                                        <p>
                                            Wrapper of parallelize
                                            generate_samples, running several
                                            threads in parallel. &lt;b&gt;Note
                                            to developers&lt;/b&gt;: this
                                            function needs to be changed if
                                            applied to other VAE model than
                                            scVI.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >sample_size:
                                                            int</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of samples to
                                                            generate.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_names: list
                                                            or np.ndarray,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            List or array with
                                                            sample_size str
                                                            values indicating
                                                            the batch of each
                                                            sample.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >covariate_values:
                                                            list or np.ndarray,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            List or array with
                                                            sample_size float
                                                            values indicating
                                                            the covariate values
                                                            of each sample to
                                                            generate (as for
                                                            training scVI
                                                            model).
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >lib_size</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dictionary of mean
                                                            library size per
                                                            batch.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong>model</strong>
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            scVI model which
                                                            decoder is here
                                                            exploited to
                                                            generate samples.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_key_dict</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dictionary linking
                                                            the values of the
                                                            batch (scVI) and the
                                                            key used in scVI.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >return_dist: bool,
                                                            default to
                                                            False</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Whether to return
                                                            the distribution
                                                            parameters (True) or
                                                            samples from this
                                                            distribution
                                                            (False).
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_size: int,
                                                            default to
                                                            10**3</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of sample to
                                                            generate per batch.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >n_jobs: int,
                                                            default to 1</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of threads to
                                                            launch. n_jobs=-1
                                                            will launch as many
                                                            threads as there are
                                                            CPUs available.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        If return_dist if False,
                                                        torch.Tensor (on CPU)
                                                        with artificial samples
                                                        in the rows.
                                                    </dt>
                                                    <dd></dd>
                                                    <dt>
                                                        If return_dist if True,
                                                        torch.Tensor with
                                                        distribution parameters
                                                        (following scVI
                                                    </dt>
                                                    <dd></dd>
                                                    <dt>
                                                        order) and one
                                                        torch.Tensor with
                                                        artificial samples in
                                                        the rows (CPU).
                                                    </dt>
                                                    <dd></dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.interpolated_features"
                            >
                                <span
                                    id="sobolev-alignment-interpolated-features-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.interpolated_features
                                    module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.interpolated_features"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Compute interpolated features.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.interpolated_features.compute_optimal_tau"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.interpolated_features.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >compute_optimal_tau</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >PV_number</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >pv_projections</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >principal_angles</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >n_interpolation</span
                                                ></span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >100</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.interpolated_features.compute_optimal_tau"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Compute the optimal interpolation
                                            step for each PV (Grassmann
                                            interpolation).
                                        </p>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.interpolated_features.project_on_interpolate_PV"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.interpolated_features.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >project_on_interpolate_PV</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >angle</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >PV_number</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >tau_step</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >pv_projections</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.interpolated_features.project_on_interpolate_PV"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>Project data on interpolated PVs.</p>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.kernel_operations"
                            >
                                <span
                                    id="sobolev-alignment-kernel-operations-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.kernel_operations module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.kernel_operations"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Kernel operations.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    Custom scripts for specific matrix
                                    operations.
                                </p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.kernel_operations.mat_inv_sqrt"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.kernel_operations.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >mat_inv_sqrt</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >M</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >threshold</span
                                                ></span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >1e-06</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.kernel_operations.mat_inv_sqrt"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Compute the inverse square root of a
                                            symmetric matrix M by SVD.
                                        </p>
                                    </dd>
                                </dl>
                            </section>
                            <section id="module-sobolev_alignment.krr_approx">
                                <span
                                    id="sobolev-alignment-krr-approx-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.krr_approx module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.krr_approx"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>
                                    Encoder approximation by Kernel Ridge
                                    Regression.
                                </p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    This modules train a Kernel Ridge Regression
                                    (KRR) on a pair of samples (x_hat) and
                                    embeddings (z_hat) using two possible
                                    implementations: - scikit-learn:
                                    deterministic, but limited in memory and
                                    time efficiency. - Falkon: stochastic
                                    Nyström approximation, faster both in memory
                                    and computation time. Optimised for multi
                                    GPUs.
                                </p>
                                <p class="rubric">References</p>
                                <p>
                                    Mourragui et al 2022 Meanti et al, Kernel
                                    methods through the roof: handling billions
                                    of points efficiently, NeurIPS, 2020.
                                    Pedregosa et al, Scikit-learn: Machine
                                    Learning in Python, Journal of Machine
                                    Learning Research, 2011.
                                </p>
                                <dl class="py class">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.krr_approx.KRRApprox"
                                    >
                                        <em class="property"
                                            ><span class="pre">class</span
                                            ><span class="w"> </span></em
                                        ><span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.krr_approx.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >KRRApprox</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >method</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#str"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >str</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >'sklearn'</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >kernel</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#str"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >str</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >'rbf'</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >M</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >100</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >kernel_params</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/typing.html#typing.Optional"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >Optional</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >[</span
                                                    ></span
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#dict"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >dict</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >]</span
                                                    ></span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >None</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >penalization</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#float"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >float</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >1e-06</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >maxiter</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >20</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >falkon_options</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/typing.html#typing.Optional"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >Optional</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >[</span
                                                    ></span
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#dict"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >dict</span
                                                    ></a
                                                ><span class="p"
                                                    ><span class="pre"
                                                        >]</span
                                                    ></span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >None</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >mean_center</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#bool"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >bool</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >False</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >unit_std</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#bool"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >bool</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >False</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.krr_approx.KRRApprox"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Bases:
                                            <a
                                                class="reference external"
                                                href="https://docs.python.org/3/library/functions.html#object"
                                                title="(in Python v3.11)"
                                                ><code
                                                    class="xref py py-class docutils literal notranslate"
                                                    ><span class="pre"
                                                        >object</span
                                                    ></code
                                                ></a
                                            >
                                        </p>
                                        <p>
                                            Kernel Ridge Regression
                                            approximation.
                                        </p>
                                        <p>
                                            This class contains the functions
                                            used to approximate the encoding
                                            functions of a Variational Auto
                                            Encoder (VAE) by a kernel machines
                                            by means of Kernel Ridge Regression
                                            (KRR). &lt;br/&gt; This class takes
                                            as input a training data and
                                            executes the learning process. The
                                            generation of artificial samples and
                                            subsequent computation of embeddings
                                            is not part of this class.
                                        </p>
                                        <p class="rubric">Methods</p>
                                        <table
                                            class="autosummary longtable docutils align-default"
                                        >
                                            <tbody>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.krr_approx.KRRApprox.anchors"
                                                                title="sobolev_alignment.krr_approx.KRRApprox.anchors"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >anchors</span
                                                                    ></code
                                                                ></a
                                                            >()
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Return anchor points
                                                            used in KRR.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-even">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.krr_approx.KRRApprox.fit"
                                                                title="sobolev_alignment.krr_approx.KRRApprox.fit"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >fit</span
                                                                    ></code
                                                                ></a
                                                            >(X, y)
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Train a regression
                                                            model (KRR) between
                                                            X and all columns of
                                                            Y.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.krr_approx.KRRApprox.load"
                                                                title="sobolev_alignment.krr_approx.KRRApprox.load"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >load</span
                                                                    ></code
                                                                ></a
                                                            >()
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Load a KRRApprox
                                                            instance.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-even">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.krr_approx.KRRApprox.save"
                                                                title="sobolev_alignment.krr_approx.KRRApprox.save"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >save</span
                                                                    ></code
                                                                ></a
                                                            >([folder])
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Save the instance.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.krr_approx.KRRApprox.transform"
                                                                title="sobolev_alignment.krr_approx.KRRApprox.transform"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >transform</span
                                                                    ></code
                                                                ></a
                                                            >(X)
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Apply the trained
                                                            KRR models to a
                                                            given data.
                                                        </p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.anchors"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >anchors</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.anchors"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Return anchor points used in
                                                    KRR.
                                                </p>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.fit"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >fit</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >X</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >Tensor</span
                                                        ></span
                                                    ></em
                                                >,
                                                <em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >y</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >Tensor</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.fit"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Train a regression model
                                                    (KRR) between X and all
                                                    columns of Y.
                                                </p>
                                                <dl class="field-list simple">
                                                    <dt class="field-odd">
                                                        Parameters<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-odd">
                                                        <dl class="simple">
                                                            <dt>
                                                                <strong
                                                                    >X:
                                                                    torch.Tensor</strong
                                                                >
                                                            </dt>
                                                            <dd>
                                                                <p>
                                                                    Tensor
                                                                    containing
                                                                    the
                                                                    artificial
                                                                    input
                                                                    (x_hat),
                                                                    with samples
                                                                    in the rows.
                                                                </p>
                                                            </dd>
                                                            <dt>
                                                                <strong
                                                                    >y:
                                                                    torch.Tensor</strong
                                                                >
                                                            </dt>
                                                            <dd>
                                                                <p>
                                                                    Tensor
                                                                    containing
                                                                    the
                                                                    artificial
                                                                    embedding
                                                                    (z_hat).
                                                                    Called y for
                                                                    compliance
                                                                    with sklearn
                                                                    functions.
                                                                </p>
                                                            </dd>
                                                        </dl>
                                                    </dd>
                                                    <dt class="field-even">
                                                        Returns<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-even">
                                                        <dl class="simple">
                                                            <dt>
                                                                self: fitted
                                                                KRRApprox
                                                                instance.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.load"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >load</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.load"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Load a KRRApprox instance.
                                                </p>
                                                <dl class="field-list simple">
                                                    <dt class="field-odd">
                                                        Parameters<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-odd">
                                                        <dl class="simple">
                                                            <dt>
                                                                <strong
                                                                    >folder:
                                                                    str, default
                                                                    to
                                                                    ‘.’</strong
                                                                >
                                                            </dt>
                                                            <dd>
                                                                <p>
                                                                    Folder path
                                                                    where the
                                                                    instance is
                                                                    located
                                                                </p>
                                                            </dd>
                                                        </dl>
                                                    </dd>
                                                    <dt class="field-even">
                                                        Returns<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-even">
                                                        <dl class="simple">
                                                            <dt>
                                                                KRRApprox:
                                                                instance saved
                                                                at the folder
                                                                location.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.save"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >save</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >folder</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><a
                                                            class="reference external"
                                                            href="https://docs.python.org/3/library/stdtypes.html#str"
                                                            title="(in Python v3.11)"
                                                            ><span class="pre"
                                                                >str</span
                                                            ></a
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="o"
                                                        ><span class="pre"
                                                            >=</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="default_value"
                                                        ><span class="pre"
                                                            >'.'</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.save"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>Save the instance.</p>
                                                <dl class="field-list simple">
                                                    <dt class="field-odd">
                                                        Parameters<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-odd">
                                                        <dl class="simple">
                                                            <dt>
                                                                <strong
                                                                    >folder:
                                                                    str, default
                                                                    to
                                                                    ‘.’</strong
                                                                >
                                                            </dt>
                                                            <dd>
                                                                <p>
                                                                    Folder path
                                                                    to use for
                                                                    saving the
                                                                    instance
                                                                </p>
                                                            </dd>
                                                        </dl>
                                                    </dd>
                                                    <dt class="field-even">
                                                        Returns<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-even">
                                                        <dl class="simple">
                                                            <dt>
                                                                True if the
                                                                instance was
                                                                properly saved.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.transform"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >transform</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >X</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >Tensor</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.transform"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Apply the trained KRR models
                                                    to a given data.
                                                </p>
                                                <p>
                                                    This corresponds to the
                                                    out-of-sample extension.
                                                </p>
                                                <dl class="field-list simple">
                                                    <dt class="field-odd">
                                                        Parameters<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-odd">
                                                        <dl class="simple">
                                                            <dt>
                                                                <strong
                                                                    >X:
                                                                    torch.Tensor</strong
                                                                >
                                                            </dt>
                                                            <dd>
                                                                <p>
                                                                    Tensor
                                                                    containing
                                                                    gene
                                                                    expression
                                                                    profiles
                                                                    with samples
                                                                    in the rows.
                                                                    &lt;b&gt;WARNING:&lt;/b&gt;
                                                                    genes
                                                                    (features)
                                                                    need to be
                                                                    following
                                                                    the same
                                                                    order as the
                                                                    training
                                                                    data.
                                                                </p>
                                                            </dd>
                                                        </dl>
                                                    </dd>
                                                    <dt class="field-even">
                                                        Returns<span
                                                            class="colon"
                                                            >:</span
                                                        >
                                                    </dt>
                                                    <dd class="field-even">
                                                        <dl class="simple">
                                                            <dt>
                                                                torch.Tensor
                                                                with predicted
                                                                values for each
                                                                of the encoding
                                                                functions.
                                                            </dt>
                                                            <dd></dd>
                                                            <dt>
                                                                Samples are in
                                                                the rows and
                                                                encoding
                                                                functions
                                                                (embedding) in
                                                                the columns.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </dd>
                                                </dl>
                                            </dd>
                                        </dl>

                                        <dl class="py attribute">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.default_kernel_params"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >default_kernel_params</span
                                                    ></span
                                                ><em class="property"
                                                    ><span class="w"> </span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >=</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="pre"
                                                        >{'falkon':</span
                                                    >
                                                    <span class="pre"
                                                        >{'gaussian':</span
                                                    >
                                                    <span class="pre"
                                                        >{'sigma':</span
                                                    >
                                                    <span class="pre">1},</span>
                                                    <span class="pre"
                                                        >'laplacian':</span
                                                    >
                                                    <span class="pre"
                                                        >{'sigma':</span
                                                    >
                                                    <span class="pre">1},</span>
                                                    <span class="pre"
                                                        >'matern':</span
                                                    >
                                                    <span class="pre"
                                                        >{'nu':</span
                                                    >
                                                    <span class="pre"
                                                        >0.5,</span
                                                    >
                                                    <span class="pre"
                                                        >'sigma':</span
                                                    >
                                                    <span class="pre">1},</span>
                                                    <span class="pre"
                                                        >'rbf':</span
                                                    >
                                                    <span class="pre"
                                                        >{'sigma':</span
                                                    >
                                                    <span class="pre"
                                                        >1}},</span
                                                    >
                                                    <span class="pre"
                                                        >'sklearn':</span
                                                    >
                                                    <span class="pre"
                                                        >{'gaussian':</span
                                                    >
                                                    <span class="pre">{},</span>
                                                    <span class="pre"
                                                        >'laplacian':</span
                                                    >
                                                    <span class="pre">{},</span>
                                                    <span class="pre"
                                                        >'matern':</span
                                                    >
                                                    <span class="pre">{},</span>
                                                    <span class="pre"
                                                        >'rbf':</span
                                                    >
                                                    <span class="pre"
                                                        >{}}}</span
                                                    ></em
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.default_kernel_params"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd></dd>
                                        </dl>

                                        <dl class="py attribute">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.falkon_kernel"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >falkon_kernel</span
                                                    ></span
                                                ><em class="property"
                                                    ><span class="w"> </span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >=</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="pre"
                                                        >{'gaussian':</span
                                                    >
                                                    <span class="pre"
                                                        >None,</span
                                                    >
                                                    <span class="pre"
                                                        >'laplacian':</span
                                                    >
                                                    <span class="pre"
                                                        >None,</span
                                                    >
                                                    <span class="pre"
                                                        >'matern':</span
                                                    >
                                                    <span class="pre"
                                                        >None,</span
                                                    >
                                                    <span class="pre"
                                                        >'rbf':</span
                                                    >
                                                    <span class="pre"
                                                        >None}</span
                                                    ></em
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.falkon_kernel"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd></dd>
                                        </dl>

                                        <dl class="py attribute">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.krr_approx.KRRApprox.sklearn_kernel"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >sklearn_kernel</span
                                                    ></span
                                                ><em class="property"
                                                    ><span class="w"> </span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >=</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="pre"
                                                        >{'gaussian':</span
                                                    >
                                                    <span class="pre"
                                                        >'wrapper',</span
                                                    >
                                                    <span class="pre"
                                                        >'laplacian':</span
                                                    >
                                                    <span class="pre"
                                                        >'wrapper',</span
                                                    >
                                                    <span class="pre"
                                                        >'matern':</span
                                                    >
                                                    <span class="pre"
                                                        >&lt;class</span
                                                    >
                                                    <span class="pre"
                                                        >'sklearn.gaussian_process.kernels.Matern'&gt;,</span
                                                    >
                                                    <span class="pre"
                                                        >'rbf':</span
                                                    >
                                                    <span class="pre"
                                                        >'wrapper'}</span
                                                    ></em
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.krr_approx.KRRApprox.sklearn_kernel"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd></dd>
                                        </dl>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.krr_model_selection"
                            >
                                <span
                                    id="sobolev-alignment-krr-model-selection-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.krr_model_selection
                                    module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.krr_model_selection"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>
                                    Kernel Ridge Regression (KRR) model search.
                                </p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    Pipeline to perform model selection for the
                                    Kernel Ridge Regression (KRR) models,
                                    employing the protocol presented in the
                                    paper, i.e.,: - Selecting sigma as the value
                                    yielding an average of 0.5 for the Gaussian
                                    kernel. - Selecting model with lowest
                                    training error on input data (trained on
                                    artificial data).
                                </p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.krr_model_selection.model_alignment_penalization"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.krr_model_selection.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >model_alignment_penalization</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >X_data</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData"
                                                    title="(in anndata v0.9.1)"
                                                    ><span class="pre"
                                                        >AnnData</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >data_source</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/stdtypes.html#str"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >str</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sobolev_alignment_clf</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sigma</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#float"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >float</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >optimal_nu</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#float"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >float</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >M</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >250</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.krr_model_selection.model_alignment_penalization"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>$\sigma$ and $nu$ selection.</p>
                                        <p>
                                            Select the optimal penalization
                                            parameter given $\sigma$ and $nu$ by
                                            aligning the data_source model to
                                            itself and measuring the principal
                                            angles. Intuitively, aligning the
                                            model to itself must yield high
                                            principal angles. Low values
                                            indicate over-fitting of the KRR.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >X_data:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dataset to employ.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >data_source: str,
                                                            ‘source’ or
                                                            ‘target’</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Name of the data
                                                            stream in
                                                            SobolevAlignment
                                                            parameters.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >sobolev_alignment_clf:
                                                            SobolevAlignment</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            SobolevAlignment
                                                            instance with scVI
                                                            models trained. Used
                                                            to find optimal $nu$
                                                            parameter on the KRR
                                                            regression step.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >sigma:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            $\sigma$ parameter
                                                            in KRR.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >optimal_nu:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Value of $nu$
                                                            (Falkon) to be used
                                                            in the optimization.
                                                            Can be established
                                                            using
                                                            model_selection_nu
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >M: int, default to
                                                            250</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of anchor
                                                            points to use in the
                                                            KRR approximation. A
                                                            larger M typically
                                                            improves the
                                                            prediction, but at
                                                            the cost of longer
                                                            compute time and
                                                            memory cost.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        DataFrame with principal
                                                        angles between the same
                                                        models.
                                                    </dt>
                                                    <dd></dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.krr_model_selection.model_selection_nu"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.krr_model_selection.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >model_selection_nu</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >X_source</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData"
                                                    title="(in anndata v0.9.1)"
                                                    ><span class="pre"
                                                        >AnnData</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >X_target</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData"
                                                    title="(in anndata v0.9.1)"
                                                    ><span class="pre"
                                                        >AnnData</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sobolev_alignment_clf</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >sigma</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#float"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >float</span
                                                    ></a
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >M</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >250</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >test_error_size</span
                                                ></span
                                            ><span class="p"
                                                ><span class="pre"
                                                    >:</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="n"
                                                ><a
                                                    class="reference external"
                                                    href="https://docs.python.org/3/library/functions.html#int"
                                                    title="(in Python v3.11)"
                                                    ><span class="pre"
                                                        >int</span
                                                    ></a
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="w"> </span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >-1</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.krr_model_selection.model_selection_nu"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Select the optimal $nu$ parameter.
                                        </p>
                                        <p>
                                            Select the optimal $nu$ parameter
                                            (Matérn kernel) by measuring the
                                            Spearman correlation for different
                                            values of $nu$ and penalization, and
                                            selecting the $nu$ with the highest
                                            correlation.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >X_source:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>Source dataset.</p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >X_target:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>Target dataset.</p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >sobolev_alignment_clf:
                                                            SobolevAlignment</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            SobolevAlignment
                                                            instance with scVI
                                                            models trained. Used
                                                            to find optimal $nu$
                                                            parameter on the KRR
                                                            regression step.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >sigma:
                                                            float</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            $sigma$ parameter in
                                                            KRR.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >M: int, default to
                                                            250</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of anchor
                                                            points to use in the
                                                            KRR approximation. A
                                                            larger M typically
                                                            improves the
                                                            prediction, but at
                                                            the cost of longer
                                                            compute time and
                                                            memory cost.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >test_error_size:
                                                            float, default to
                                                            -1</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of input
                                                            points to be
                                                            considered when
                                                            computing the error.
                                                            Input (X_source and
                                                            X_target) are not
                                                            used to train the
                                                            KRR (artificial
                                                            points are) and are
                                                            acting as proxy for
                                                            validation set.
                                                            Setting
                                                            test_error_size=-1
                                                            would lead to using
                                                            the complete input
                                                            data
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        DataFrame with spearman
                                                        correlation on source
                                                        and target data for
                                                        various
                                                    </dt>
                                                    <dd></dd>
                                                    <dt>
                                                        hyper-parameter values.
                                                    </dt>
                                                    <dd></dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.multi_krr_approx"
                            >
                                <span
                                    id="sobolev-alignment-multi-krr-approx-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.multi_krr_approx module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.multi_krr_approx"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>Multi KRR approximation.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    Scripts supporting the naive integration of
                                    several KRR. No gain is provided by such
                                    approach.
                                </p>
                                <dl class="py class">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.multi_krr_approx.MultiKRRApprox"
                                    >
                                        <em class="property"
                                            ><span class="pre">class</span
                                            ><span class="w"> </span></em
                                        ><span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.multi_krr_approx.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >MultiKRRApprox</span
                                            ></span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Bases:
                                            <a
                                                class="reference external"
                                                href="https://docs.python.org/3/library/functions.html#object"
                                                title="(in Python v3.11)"
                                                ><code
                                                    class="xref py py-class docutils literal notranslate"
                                                    ><span class="pre"
                                                        >object</span
                                                    ></code
                                                ></a
                                            >
                                        </p>
                                        <p>
                                            Multi Kernel Ridge Regression
                                            approximation.
                                        </p>
                                        <p>
                                            This class contains a wrapper around
                                            KRRApprox to serialise the
                                            approximation of latent factors.
                                            Several experiments show that such
                                            approach does not yield any
                                            advantage.
                                        </p>
                                        <p class="rubric">Methods</p>
                                        <table
                                            class="autosummary longtable docutils align-default"
                                        >
                                            <tbody>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.add_clf"
                                                                title="sobolev_alignment.multi_krr_approx.MultiKRRApprox.add_clf"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >add_clf</span
                                                                    ></code
                                                                ></a
                                                            >(clf)
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>Add a classifier.</p>
                                                    </td>
                                                </tr>
                                                <tr class="row-even">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.anchors"
                                                                title="sobolev_alignment.multi_krr_approx.MultiKRRApprox.anchors"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >anchors</span
                                                                    ></code
                                                                ></a
                                                            >()
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>Return anchors.</p>
                                                    </td>
                                                </tr>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.predict"
                                                                title="sobolev_alignment.multi_krr_approx.MultiKRRApprox.predict"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >predict</span
                                                                    ></code
                                                                ></a
                                                            >(X)
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Predict latent
                                                            factor values given
                                                            a tensor.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-even">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.process_clfs"
                                                                title="sobolev_alignment.multi_krr_approx.MultiKRRApprox.process_clfs"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >process_clfs</span
                                                                    ></code
                                                                ></a
                                                            >()
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Process the
                                                            different
                                                            classifiers.
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="row-odd">
                                                    <td>
                                                        <p>
                                                            <a
                                                                class="reference internal"
                                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.transform"
                                                                title="sobolev_alignment.multi_krr_approx.MultiKRRApprox.transform"
                                                                ><code
                                                                    class="xref py py-obj docutils literal notranslate"
                                                                    ><span
                                                                        class="pre"
                                                                        >transform</span
                                                                    ></code
                                                                ></a
                                                            >(X)
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p>
                                                            Predict latent
                                                            factor values given
                                                            a tensor.
                                                        </p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.multi_krr_approx.MultiKRRApprox.add_clf"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >add_clf</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >clf</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.add_clf"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd><p>Add a classifier.</p></dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.multi_krr_approx.MultiKRRApprox.anchors"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >anchors</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.anchors"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd><p>Return anchors.</p></dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.multi_krr_approx.MultiKRRApprox.predict"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >predict</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >X</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >Tensor</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.predict"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Predict latent factor values
                                                    given a tensor.
                                                </p>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.multi_krr_approx.MultiKRRApprox.process_clfs"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >process_clfs</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.process_clfs"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Process the different
                                                    classifiers.
                                                </p>
                                            </dd>
                                        </dl>

                                        <dl class="py method">
                                            <dt
                                                class="sig sig-object py"
                                                id="sobolev_alignment.multi_krr_approx.MultiKRRApprox.transform"
                                            >
                                                <span class="sig-name descname"
                                                    ><span class="pre"
                                                        >transform</span
                                                    ></span
                                                ><span class="sig-paren">(</span
                                                ><em class="sig-param"
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >X</span
                                                        ></span
                                                    ><span class="p"
                                                        ><span class="pre"
                                                            >:</span
                                                        ></span
                                                    ><span class="w"> </span
                                                    ><span class="n"
                                                        ><span class="pre"
                                                            >Tensor</span
                                                        ></span
                                                    ></em
                                                ><span class="sig-paren">)</span
                                                ><a
                                                    class="headerlink"
                                                    href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox.transform"
                                                    title="Permalink to this definition"
                                                    >¶</a
                                                >
                                            </dt>
                                            <dd>
                                                <p>
                                                    Predict latent factor values
                                                    given a tensor.
                                                </p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>
                            </section>
                            <section
                                id="module-sobolev_alignment.scvi_model_search"
                            >
                                <span
                                    id="sobolev-alignment-scvi-model-search-module"
                                ></span>
                                <h2>
                                    sobolev_alignment.scvi_model_search module<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment.scvi_model_search"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                                <p>scVI model search.</p>
                                <p>&#64;author: Soufiane Mourragui</p>
                                <p>
                                    Pipeline to perform model selection for the
                                    scVI model.
                                </p>
                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.scvi_model_search.make_objective_function"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.scvi_model_search.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >make_objective_function</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >train_data_an</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >test_data_an</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_key=None</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >model=&lt;class</span
                                                >
                                                <span class="pre"
                                                    >'scvi.model._scvi.SCVI'&gt;</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.scvi_model_search.make_objective_function"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Generate Hyperopt objective
                                            function.
                                        </p>
                                        <p>
                                            Generate the hyperopt objective
                                            function performing, for one set of
                                            hyperparameters, the training, the
                                            evaluation on test data and summing
                                            up all the results in a dictionary
                                            usable for Hyperopt.
                                        </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >train_data_an:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            AnnData containing
                                                            the train samples.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >test_data_an:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            AnnData containing
                                                            the test samples.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_key: str,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Name of the batch
                                                            key to be used in
                                                            scVI.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >model: default to
                                                            scvi.model.SCVI</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Model from
                                                            scvi-tools to be
                                                            used.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>
                                                        function which can be
                                                        called using a
                                                        dictionary of
                                                        parameters.
                                                    </dt>
                                                    <dd></dd>
                                                </dl>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.scvi_model_search.model_selection"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.scvi_model_search.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >model_selection</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >data_an:</span
                                                >
                                                <span class="pre"
                                                    >~anndata._core.anndata.AnnData</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >batch_key:</span
                                                >
                                                <span class="pre"
                                                    >~typing.Optional[str]</span
                                                >
                                                <span class="pre">=</span>
                                                <span class="pre"
                                                    >None</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >model=&lt;class</span
                                                >
                                                <span class="pre"
                                                    >'scvi.model._scvi.SCVI'&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >space={'dispersion':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'dropout_rate':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'early_stopping':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'gene_likelihood':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre">'lr':</span>
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'n_hidden':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'n_latent':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'n_layers':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'reduce_lr_on_plateau':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >'weight_decay':</span
                                                >
                                                <span class="pre"
                                                    >&lt;hyperopt.pyll.base.Apply</span
                                                >
                                                <span class="pre"
                                                    >object&gt;}</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >max_eval=100</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >test_size=0.1</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >save=None</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.scvi_model_search.model_selection"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Model selection for scVI instances
                                            (hyper-parameter search).
                                        </p>
                                        <p>
                                            Perform model selection on an scVI
                                            model by dividing a dataset into
                                            training and testing, and
                                            subsequently performing Bayesian
                                            Optimisation on the test data.
                                        </p>
                                        <dl class="field-list">
                                            <dt class="field-odd">
                                                Parameters<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-odd">
                                                <dl class="simple">
                                                    <dt>
                                                        <strong
                                                            >data_an:
                                                            AnnData</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Datasets to be used
                                                            in the model
                                                            selection.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >batch_key: str,
                                                            default to
                                                            None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Name of the batch
                                                            key to be used in
                                                            scVI.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >model: default to
                                                            scvi.model.SCVI</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Model from
                                                            scvi-tools to be
                                                            used.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >space: dict,
                                                            default to
                                                            DEFAULT_HYPEROPT_SPACE</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Dictionary with
                                                            hyper-parameter
                                                            space to be used in
                                                            Bayesian
                                                            optimisation.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >max_eval: int,
                                                            default to
                                                            100</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Number of iterations
                                                            in the Bayesian
                                                            optimisation
                                                            procedures, i.e.,
                                                            number of models
                                                            assessed.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >test_size: float,
                                                            default to
                                                            0.1</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Proportion of
                                                            samples (cells) to
                                                            be taken inside the
                                                            test data.
                                                        </p>
                                                    </dd>
                                                    <dt>
                                                        <strong
                                                            >save: str, default
                                                            to None</strong
                                                        >
                                                    </dt>
                                                    <dd>
                                                        <p>
                                                            Path to save
                                                            Bayesian
                                                            optimisation results
                                                            to. Must be a csv
                                                            file. If set to
                                                            None, then results
                                                            are not saved.
                                                        </p>
                                                    </dd>
                                                </dl>
                                            </dd>
                                            <dt class="field-even">
                                                Returns<span class="colon"
                                                    >:</span
                                                >
                                            </dt>
                                            <dd class="field-even">
                                                <dl class="simple">
                                                    <dt>Tuple containing:</dt>
                                                    <dd></dd>
                                                </dl>
                                                <ul class="simple">
                                                    <li>
                                                        <dl class="simple">
                                                            <dt>
                                                                Best model given
                                                                by hyperopt.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </li>
                                                    <li>
                                                        <dl class="simple">
                                                            <dt>
                                                                DataFrame with
                                                                Bayesian
                                                                optimisation
                                                                results.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </li>
                                                    <li>
                                                        <dl class="simple">
                                                            <dt>
                                                                Trials instance
                                                                from hyperopt.
                                                            </dt>
                                                            <dd></dd>
                                                        </dl>
                                                    </li>
                                                </ul>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt
                                        class="sig sig-object py"
                                        id="sobolev_alignment.scvi_model_search.split_dataset"
                                    >
                                        <span class="sig-prename descclassname"
                                            ><span class="pre"
                                                >sobolev_alignment.scvi_model_search.</span
                                            ></span
                                        ><span class="sig-name descname"
                                            ><span class="pre"
                                                >split_dataset</span
                                            ></span
                                        ><span class="sig-paren">(</span
                                        ><em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >data_an</span
                                                ></span
                                            ></em
                                        >,
                                        <em class="sig-param"
                                            ><span class="n"
                                                ><span class="pre"
                                                    >test_size</span
                                                ></span
                                            ><span class="o"
                                                ><span class="pre"
                                                    >=</span
                                                ></span
                                            ><span class="default_value"
                                                ><span class="pre"
                                                    >0.1</span
                                                ></span
                                            ></em
                                        ><span class="sig-paren">)</span
                                        ><a
                                            class="headerlink"
                                            href="#sobolev_alignment.scvi_model_search.split_dataset"
                                            title="Permalink to this definition"
                                            >¶</a
                                        >
                                    </dt>
                                    <dd>
                                        <p>
                                            Split between training and testing.
                                        </p>
                                    </dd>
                                </dl>
                            </section>
                            <section id="module-sobolev_alignment">
                                <span id="module-contents"></span>
                                <h2>
                                    Module contents<a
                                        class="headerlink"
                                        href="#module-sobolev_alignment"
                                        title="Permalink to this heading"
                                        >¶</a
                                    >
                                </h2>
                            </section>
                        </section>
                    </div>
                </div>
            </div>
            <div
                class="sphinxsidebar"
                role="navigation"
                aria-label="main navigation"
            >
                <div class="sphinxsidebarwrapper">
                    <h1 class="logo">
                        <a href="../index.html">Sobolev Alignment</a>
                    </h1>

                    <h3>Navigation</h3>
                    <p class="caption" role="heading">
                        <span class="caption-text">Contents:</span>
                    </p>
                    <ul class="current">
                        <li class="toctree-l1">
                            <a class="reference internal" href="modules.html"
                                >sobolev_alignment</a
                            >
                        </li>
                        <li class="toctree-l1 current">
                            <a class="current reference internal" href="#"
                                >sobolev_alignment package</a
                            >
                            <ul>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#submodules"
                                        >Submodules</a
                                    >
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.SobolevAlignment"
                                        >sobolev_alignment.SobolevAlignment
                                        module</a
                                    >
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.feature_analysis"
                                        >sobolev_alignment.feature_analysis
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.feature_analysis.basis"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >basis()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.feature_analysis.combinatorial_product"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >combinatorial_product()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.feature_analysis.higher_order_contribution"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >higher_order_contribution()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.generate_artificial_sample"
                                        >sobolev_alignment.generate_artificial_sample
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.generate_artificial_sample.generate_samples"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >generate_samples()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.generate_artificial_sample.parallel_generate_samples"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >parallel_generate_samples()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.interpolated_features"
                                        >sobolev_alignment.interpolated_features
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.interpolated_features.compute_optimal_tau"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >compute_optimal_tau()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.interpolated_features.project_on_interpolate_PV"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >project_on_interpolate_PV()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.kernel_operations"
                                        >sobolev_alignment.kernel_operations
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.kernel_operations.mat_inv_sqrt"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >mat_inv_sqrt()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.krr_approx"
                                        >sobolev_alignment.krr_approx module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.krr_approx.KRRApprox"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >KRRApprox</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.krr_model_selection"
                                        >sobolev_alignment.krr_model_selection
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.krr_model_selection.model_alignment_penalization"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >model_alignment_penalization()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.krr_model_selection.model_selection_nu"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >model_selection_nu()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.multi_krr_approx"
                                        >sobolev_alignment.multi_krr_approx
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.multi_krr_approx.MultiKRRApprox"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >MultiKRRApprox</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment.scvi_model_search"
                                        >sobolev_alignment.scvi_model_search
                                        module</a
                                    >
                                    <ul>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.scvi_model_search.make_objective_function"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >make_objective_function()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.scvi_model_search.model_selection"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >model_selection()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                        <li class="toctree-l3">
                                            <a
                                                class="reference internal"
                                                href="#sobolev_alignment.scvi_model_search.split_dataset"
                                                ><code
                                                    class="docutils literal notranslate"
                                                    ><span class="pre"
                                                        >split_dataset()</span
                                                    ></code
                                                ></a
                                            >
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2">
                                    <a
                                        class="reference internal"
                                        href="#module-sobolev_alignment"
                                        >Module contents</a
                                    >
                                </li>
                            </ul>
                        </li>
                    </ul>

                    <div class="relations">
                        <h3>Related Topics</h3>
                        <ul>
                            <li>
                                <a href="../index.html"
                                    >Documentation overview</a
                                >
                                <ul>
                                    <li>
                                        Previous:
                                        <a
                                            href="modules.html"
                                            title="previous chapter"
                                            >sobolev_alignment</a
                                        >
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div id="searchbox" style="display: none" role="search">
                        <h3 id="searchlabel">Quick search</h3>
                        <div class="searchformwrapper">
                            <form
                                class="search"
                                action="../search.html"
                                method="get"
                            >
                                <input
                                    type="text"
                                    name="q"
                                    aria-labelledby="searchlabel"
                                    autocomplete="off"
                                    autocorrect="off"
                                    autocapitalize="off"
                                    spellcheck="false"
                                />
                                <input type="submit" value="Go" />
                            </form>
                        </div>
                    </div>
                    <script>
                        document.getElementById("searchbox").style.display =
                            "block";
                    </script>
                </div>
            </div>
            <div class="clearer"></div>
        </div>
        <div class="footer">
            &copy;2023, Soufiane Mourragui. | Powered by
            <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a> &amp;
            <a href="https://github.com/bitprophet/alabaster"
                >Alabaster 0.7.13</a
            >

            |
            <a
                href="../_sources/content/sobolev_alignment.rst.txt"
                rel="nofollow"
                >Page source</a
            >
        </div>
    </body>
</html>
